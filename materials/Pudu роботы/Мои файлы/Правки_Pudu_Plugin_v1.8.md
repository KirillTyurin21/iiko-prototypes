# Правки прототипа Pudu Plugin v1.8

> Дата: 2026-02-18  
> Основание: Замечания из файла «Мои личные наблюдения по тестам прототипов Pudu Plugin.md»

---

## Замечание 1: Порядок секций в каталоге

### Что было
На странице каталога (`#/prototype/front-pudu-plugin`) секция **«Контекст: Из заказа»** располагалась выше секции **«Контекст: Главный экран»**.

### Что стало
Секция **«Контекст: Главный экран»** перемещена на первое место (выше секции «Контекст: Из заказа»).

### Затронутые файлы
- `catalog-entries.ts` — изменён порядок элементов в массиве `CATALOG_SECTIONS`

---

## Замечание 2: Переработка навигации главного экрана

### Что было
На POS-экране в контексте «Главный экран» внизу отображались **3 кнопки**:
- **Маркетинг** → открывал окно выбора робота для маркетинга
- **Уборка (столы)** → открывал мультивыбор столов для уборки
- **Статус роботов** → открывал read-only таблицу статусов

### Что стало
Три кнопки заменены на **одну кнопку «Дополнения»** — стандартную кнопку Front для вызова функционала плагинов.

#### Новая цепочка навигации:

```
Главный экран → [Дополнения] → Окно «Плагины» → выбор действия
```

**Окно «Плагины»**:
- Заголовок: «Плагины»
- Сетка прямоугольных кнопок 3×6 (стиль Front — белые прямоугольники `h-16`, аналогичные цифровому табло в прототипе «Поиск клиента»)
- Две активные кнопки:
  - **«Pudu: Статус роботов»** → открывает существующее модальное окно «Статус роботов» (П7)
  - **«Pudu: Команды»** → открывает новое окно «Команды роботам»
- Остальные ячейки — пустые плейсхолдеры (серые), демонстрирующие формат окна

**Окно «Команды роботам»**:
- Заголовок: «Команды роботам»
- Кнопка «Назад» (стрелка влево) — возврат к окну «Плагины»
- Две кнопки:
  - **«Уборка (Столы)»** → открывает существующее окно мультивыбора столов для уборки
  - **«Маркетинг»** → открывает существующее окно выбора робота для маркетинга

### Затронутые файлы и конкретные изменения

#### `types.ts`
- Добавлены новые типы модальных окон `PuduModalType`:
  - `'plugins_menu'` — окно «Плагины»
  - `'pudu_commands'` — окно «Команды роботам»

#### `pudu-pos-screen.component.ts` (шаблон)
- Заменён блок из 3 кнопок (`grid-cols-3`) на 1 кнопку «Дополнения» (`grid-cols-1`)
- Добавлено inline-модальное окно «Плагины» (`activeModal === 'plugins_menu'`):
  - Сетка `grid-cols-3` с белыми кнопками (`h-16 bg-white text-black border border-gray-300 rounded`)
  - 2 активные кнопки + 16 пустых плейсхолдеров
- Добавлено inline-модальное окно «Команды роботам» (`activeModal === 'pudu_commands'`):
  - Заголовок с кнопкой «Назад» → возврат к `plugins_menu`
  - 2 белые прямоугольные кнопки

#### `pudu-pos-screen.component.ts` (логика)
- Добавлено свойство `pluginPlaceholders` — массив из 16 элементов для рендера пустых ячеек
- Добавлены методы:
  - `openPluginsMenu()` — открывает окно «Плагины»
  - `onPluginRobotStatus()` — из «Плагины» → существующее окно «Статус роботов»
  - `onPluginPuduCommands()` — из «Плагины» → окно «Команды роботам»
  - `onCommandCleanup()` — из «Команды» → существующая мультивыбор уборки
  - `onCommandMarketing()` — из «Команды» → существующий выбор робота для маркетинга

#### `catalog-entries.ts`
- Добавлены 2 новые ячейки каталога в секцию «Контекст: Главный экран»:
  - **«Дополнения → Плагины»** (`modalType: 'plugins_menu'`) — бейдж v1.8
  - **«Команды роботам»** (`modalType: 'pudu_commands'`) — бейдж v1.8
- Существующие ячейки (Уборка мультивыбор, Маркетинг, Статус роботов) сохранены для прямого доступа из каталога

#### `icons.module.ts`
- Зарегистрирована новая иконка `Terminal` (для ячейки каталога «Команды роботам»)

---

## Ключевые принципы изменений

1. **Стандартная навигация Front**: кнопка «Дополнения» — это стандартный паттерн Front для доступа к функционалу плагинов
2. **Обратная совместимость**: все существующие модальные окна (Статус роботов, Уборка мультивыбор, Выбор робота для маркетинга) не изменены — к ним добавлена новая точка входа
3. **Каталог сохраняет прямой доступ**: ячейки каталога для уборки, маркетинга и статуса — по-прежнему открывают модалки напрямую
4. **Визуальный стиль кнопок** в окне «Плагины» повторяет стиль цифрового табло из прототипа «Поиск клиента» (`front-plugins`)
